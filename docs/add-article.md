# Jamstack でコンテンツを更新する

## 記事を追加する

`Nuxt/Content` で記事を追加するには `content` ディレクトリに Markdown ファイルを作成します（ファイル名は `github.md` 等とします）。

以下のようにフロントマターと呼ばれる記事のヘッダー情報と本文から構成される Markdown ファイルを作成します。

```markdown
---
title: GitHub について
date: 2021.9.7
---

## GitHub とは

GitHub は、ユーザのみなさんからヒントを得て作成された開発プラットフォームです。

### 何ができる？

- オープンソースプロジェクトやビジネスユースまで、ソースコードをホスティングできる
- 数百万人もの他の開発者と一緒にコードのレビューを行うことができる
- プロジェクトの管理をしながら、ソフトウェアの開発を行うことができる
```

ブラウザで記事一覧の URL `http://localhost:4280` を開いて、記事が追加されたことを確認します。

## 静的ファイルを出力する

Azure Static Web Apps には、全ての記事が静的ファイルとして出力された状態でデプロイします。そうすることで、動的な読み込みが発生せず高速で安全なサイトを構成することができます。

以下のコマンドでローカル環境で静的ファイルを出力することができます（実際には CD/CD 環境で実行される）。

```sh
npm run generate
```

`dist` ディレクトリが生成され、静的ファイルが出力されていることを確認します。

SWA CLI を使って、静的ファイルベースでの動作確認を行います。

```sh
swa start dist
```

動的な構成でのアプリケーションと同じように記事が表示されてれば成功です。

GitHub にプッシュして Azure 上での動作確認を行います。

```sh
git add content/github.md
git commit
git push
```

## 記事を更新する

記事を更新するには、`content` ディレクトリ以下の Markdown ファイルを編集します。ここでは、微細な修正を行うケースを想定して、GitHub 上で直接 Markdown を更新します。

- GitHub リポジトリで `Code` タブから `content/hello.md` を開きます。
- ブラウザで Markdown が表示されたら、キーボードで `.` を打鍵すると、ブラウザ上でエディタが開きます。

まず、新しいブランチに切替えてみましょう。

- 左下に表示されている現在のブランチ名（ `main` ）を選択してプルダウンの選択肢から「+ Create New Branch...」を選択します。
- 任意のブランチ名（ `update-content` など）を入力し、確定します。
- ブランチを切り替えるか確認されるので、「Switch to Branch」ボタンを選択し切替えます。

ブランチが切替えられたら、以下のようにフロントマターに `date` 属性を追加します。

```markdown
---
title: Getting started
date: 2021.8.31
---

Empower your NuxtJS application with `@nuxtjs/content` ...（以下省略）
```

エディタ左メニューの Source Control アイコンから変更をコミットします(明示的なプッシュは不要)。

つぎに、GitHub リポジトリ上で、変更を確認してみましょう。

エディタ左下の「>< GitHub」を選択し

`Actions` タブで CI/CD の進行状況を確認した後、Static Web App の URL で記事の変更が反映されたことを確認します。
